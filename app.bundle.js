!function(t){var e={};function s(n){if(e[n])return e[n].exports;var i=e[n]={i:n,l:!1,exports:{}};return t[n].call(i.exports,i,i.exports,s),i.l=!0,i.exports}s.m=t,s.c=e,s.d=function(t,e,n){s.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},s.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},s.t=function(t,e){if(1&e&&(t=s(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(s.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)s.d(n,i,function(e){return t[e]}.bind(null,i));return n},s.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return s.d(e,"a",e),e},s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},s.p="",s(s.s=0)}([function(t,e,s){"use strict";s.r(e);class n{constructor(t){this.container=t}showWidget(){const t=document.createElement("div");t.classList.add("wrapper"),t.innerHTML='\n        <h2 class="header">Worklog:</h2>\n        <div class="list worklog"></div>\n     ',this.container.insertAdjacentElement("beforeend",t)}static showLog(t){const e=document.querySelector(".worklog");console.log(e);const s=document.createElement("div");s.classList.add("inst"),s.innerHTML=`\n        <div class="date">${t.date}</div>\n        <div class="id">Server: ${t.id}</div>\n        <div class="info">INFO: ${t.info}</div>\n      `,e.insertAdjacentElement("beforeend",s),document.querySelectorAll(".wrapper")[1].scrollTop=9999}}class i{constructor(t,e,s,n,i){this.container=t,this.createInst=e,this.stopInst=s,this.startInst=n,this.deleteInst=i}showWidget(){const t=document.createElement("div");t.classList.add("wrapper"),t.innerHTML='\n        <h2 class="header">Your micro instances</h2>\n        <div class="list instance"></div>\n        <div class="footer">Create new instance</div>  \n     ',this.container.insertAdjacentElement("beforeend",t),this.container.addEventListener("click",t=>{t.target.classList.contains("footer")?this.createInst():t.target.classList.contains("action-delete")?this.deleteInst(t.target.closest(".actions").id):t.target.classList.contains("action-running")?this.stopInst(t.target.closest(".actions").id):t.target.classList.contains("action-stopped")&&this.startInst(t.target.closest(".actions").id)})}static showInst(t){const e=document.querySelector(".instance");e.classList.add("list");const s=document.createElement("div");let n;s.classList.add("inst"),n="running"===t.state?"&#9658":"&#9616;&nbsp;&#9612;",s.innerHTML=`\n            <div class="id">${t.id}</div>\n            <div class="status">\n                Status: \n                <div class="icon-${t.state}"></div>\n                ${t.state}\n            </div>\n            <div class="actions" id="${t.id}">\n                  Actions:\n                  <div class="action-${t.state}">${n}</div>\n                  <div class="action-delete">&#10006</div>\n            </div>\n      `,e.insertAdjacentElement("beforeend",s),document.querySelector(".wrapper").scrollTop=9999}static clearServers(){const t=document.querySelector(".instance");for(;t.firstChild;)t.removeChild(t.firstChild)}}class o{constructor(){this.ws=new WebSocket("wss://ahj-cloud-backend.herokuapp.com/ws"),this.listInst=[],this.listLog=[],this.ws.addEventListener("open",()=>{console.log("connected")}),this.ws.addEventListener("message",t=>{const e=JSON.parse(t.data);"received"===e.type?(console.log(e),n.showLog(e.data)):(console.log(e),n.showLog(e.data),i.clearServers(),e.data.instances.forEach(t=>{i.showInst(t)}))}),this.ws.addEventListener("close",t=>{console.log("connection closed",t)}),this.ws.addEventListener("error",()=>{console.log("error")})}create(){this.ws.send(JSON.stringify({type:"create"}))}delete(t){this.ws.send(JSON.stringify({type:"delete",data:{id:t}}))}start(t){this.ws.send(JSON.stringify({type:"start",data:{id:t}}))}stop(t){this.ws.send(JSON.stringify({type:"stop",data:{id:t}}))}}(new class{constructor(){this.container=document.getElementById("widget"),this.api=new o,this.createInst=this.createInst.bind(this),this.stopInst=this.stopInst.bind(this),this.startInst=this.startInst.bind(this),this.deleteInst=this.deleteInst.bind(this)}start(){const t=new i(this.container,this.createInst,this.stopInst,this.startInst,this.deleteInst),e=new n(this.container);t.showWidget(),e.showWidget()}createInst(){this.api.create()}stopInst(t){this.api.stop(t)}startInst(t){this.api.start(t)}deleteInst(t){this.api.delete(t)}}).start()}]);